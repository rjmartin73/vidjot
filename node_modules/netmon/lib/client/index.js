/**!
 * Client/index.js
 */


/* Require modules */
var net = require('net');

var Client = function(host, port) {
	this.host = host;
	this.port = port;
}

/* Module exports */
module.exports = Client;

/**
 * Excecutes the given command
 * @param {String} command, the executable
 * @param {String} args, the command arguments
 * @param {Function} callback, the callback to execute.
 */
Client.prototype.exec = function(command, args, callback) {
	var message = (command && args)
		? 'action=run&command=' + command + '&args=' + args
		: 'action=run&command=' + command;
		
	var hasCallBack = (typeof callback === 'undefined' || callback === null)
		? false
		: (typeof callback !== 'function') ? false : true;
		
	socket = net.connect(this.port, this.host, function() {
		socket.write(message);
		socket.on('data', function(data) {
			if(hasCallBack) {
				callback(false, data.toString());
			}
		});
	})
	socket.on('error', function(err) {
		if (hasCallBack) {
			callback(err, null);
		} else {
			throw err;
		}
	})
}